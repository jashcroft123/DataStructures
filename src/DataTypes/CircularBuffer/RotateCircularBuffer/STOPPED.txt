Strangely using rotate array didn't offer performance over manually managing head and tail so the development was stopped